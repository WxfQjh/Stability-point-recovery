## Stability point cloud recovery based on WGAN with Transformer

This is the Pytorch implementation for the paper "Stability point cloud recovery based on WGAN with Transformer"

## Getting Started
python version: python-3.7;  cuda version: cuda-11;  

## Datasets
 [PCN's dataset](https://github.com/wentaoyuan/pcn)  
    
## Pretrain Encoder-Decoder module
To pretrain the module: python train.py  

## Pretrain WGAN module
To pretrain the module: python WGANTrainer.py  


| Method     | Plane         | Cabinet        | Car           | Chair          | Lamp           | Sofa           | Table         | vessel        | Average       |
|------------|---------------|----------------|---------------|----------------|----------------|----------------|---------------|---------------|---------------|
| PCN\*      | 5.87/0.38     | 11.12/0.64     | **9.28/0.52** | 11.83/**0.61** | 12.78/0.82     | 13.32/0.59     | **9.48/0.55** | 10.79/0.60    | 10.56/0.59    |
| GRNet\*    | 7.21/-        | 12.23/**-**    | 10.01/-       | 11.16/**-**    | 9.18/-         | 12.96-         | 9.72/-        | 8.81/-        | 10.16/-       |
| PMPNet++\* | 6.67          | 12.71          | 10.69         | 11.25          | **8.72**       | 12.73          | 9.67          | **8.75**      | 10.13         |
| Our (2k)   | **5.57/0.36** | <strong>11.04/</strong>0.59 | 9.90/0.57     | **10.41**/0.62 | 11.70/**0.74** | **10.45/0.56** | 9.73/0.62     | 8.95/**0.57** | **9.72/0.58** |

| Method       | Plane         | Cabinet        | Car            | Chair          | Lamp           | Sofa           | Table          | vessel         | Average        |
|--------------|---------------|----------------|----------------|----------------|----------------|----------------|----------------|----------------|----------------|
| PCN\* (16)   | 11.48/0.59    | 23.36/**1.24** | 19.77/0.87     | 26.10/1.12     | 22.16/1.18     | 21.94/0.95     | 19.10/1.00     | 17.25/0.85     | 20.15/0.97     |
| GRNet\* (16) | 16.39/**-**   | 36.81/**-**    | 28.24/-        | 33.73/-        | 24.96/-        | 32.43/-        | 31.42/-        | 21.82/-        | 28.23/-        |
| Our& (16)    | **7.42/0.45** | **17.67**/1.49 | **12.71/0.63** | **20.74/1.03** | **17.30/1.05** | **19.12/0.86** | **13.28/0.89** | **13.13/0.70** | **15.17/0.89** |

表四、2048 Ablation study, （CD↓/EMD↓）, CD l1_loss(10-3), EMD loss(10-1)

| Method                  | Plane         | Cabinet        | Car           | Chair          | Lamp           | Sofa           | Table         | Boat          | Average       |
|-------------------------|---------------|----------------|---------------|----------------|----------------|----------------|---------------|---------------|---------------|
| PCN                     | 5.87/0.38     | 11.12/0.64     | **9.28/0.52** | 11.83/**0.61** | 12.78/0.82     | 13.32/0.59     | **9.48/0.55** | 10.79/0.60    | 10.56/0.59    |
| PCN + PointNet++ module | 5.80/0.38     | 10.97/0.63     | 9.97/0.54     | 11.65/0.60     | 12.41/0.79     | 12.04/0.59     | 9.69/0.59     | 10.09/0.60    | 10.33/0.59    |
| PCN + Transformer       | 5.77/0.38     | 11.22/0.65     | 10.13/0.59    | 11.10/0.63     | 12.03/0.76     | 11.02/0.58     | 9.60/0.59     | 9.93/0.59     | 10.10/0.59    |
| PCN + WGAN              | 5.65/0.38     | 11.10/0.62     | 9.17/0.52     | 10.90/0.61     | 12.00/0.76     | 10.95/0.59     | 9.44/0.55     | 10.01/0.60    | 9.90/0.58     |
| Our                     | **5.57/0.36** | **11.04/0.59** | 9.90/0.57     | **10.41**/0.62 | **11.70/0.74** | **10.45/0.56** | 9.73/0.62     | **8.95/0.57** | **9.72/0.58** |

表五、16Ablation study

| Method                  | Plane         | Cabinet        | Car            | Chair          | Lamp           | Sofa           | Table          | Boat           | Average        |
|-------------------------|---------------|----------------|----------------|----------------|----------------|----------------|----------------|----------------|----------------|
| PCN                     | 11.48/0.59    | 23.36/**1.24** | 19.77/0.87     | 26.10/1.12     | 22.16/1.18     | 21.94/0.95     | 19.10/1.00     | 17.25/0.85     | 20.15/0.97     |
| PCN + PointNet++ module | 10.96/0.57    | 22.97/1.23     | 18.98/0.86     | 25.27/1.10     | 21.97/1.18     | 20.99/0.94     | 18.32/0.99     | 16.38/0.84     | 19.48/0.96     |
| PCN + Transformer       | 9.94/0.56     | 22.01/1.22     | 17.73/0.86     | 24.63/1.09     | 20.86/1.16     | 19.87/0.93     | 17.54/0.98     | 15.84/0.83     | 18.55/0.95     |
| PCN + WGAN              | 8.28/0.49     | 19.93/1.51     | 14.73/0.65     | 22.31/1.04     | 19.51/1.08     | 21.07/0.89     | 15.47/0.94     | 14.94/0.79     | 17.03/0.92     |
| Our                     | **7.42/0.45** | **17.67**/1.49 | **12.71/0.63** | **20.74/1.03** | **17.30/1.05** | **19.12/0.86** | **13.28/0.89** | **13.13/0.70** | **15.17/0.89** |


## Acknowledgements 
Our implementations use the code from the following repository:  
[PCN](https://github.com/wentaoyuan/pcn)     
[PointNet++](https://github.com/charlesq34/pointnet2)   
[PCT](https://github.com/MenghaoGuo/PCT)   
[External Attention](https://github.com/MenghaoGuo/EANet)
